 # vi: ft=sh
 #                              __ _ _
 #       __  ___ __  _ __ ___  / _(_) | ___
 #       \ \/ / '_ \| '__/ _ \| |_| | |/ _ \
 #        >  <| |_) | | | (_) |  _| | |  __/
 #       /_/\_\ .__/|_|  \___/|_| |_|_|\___|
 #            |_|

# clear download folder
bash -c "mv ~/Downloads/* mv ~/Downloads/old" &

# backup packages list
# zsh -c "pacman -Qqe >! ~/Git/dotfiles/scripts/backup/pkglist.txt" &

# automute while afk
if ! ps aux | egrep [a]utomute ; then
    bash -c "~/scripts/automute.sh" &
fi

# autoupdate system (pacman / yaourt)
if ! ps aux | egrep [a]update ; then
    bash -c "~/scripts/autoupdate.bash" &
fi

# monitor events
if ! ps aux | egrep [m]onitoring ; then
    [ -f ~/scripts/monitoring  ] && ~/scripts/monitoring  &
fi

# sync github mirror repositories
if ! ps aux | egrep [m]irror ; then
    [ -f ~/scripts/mirror ] && ~/scripts/mirror &
fi

# low memory warning (freeze swap prevention)
if ! ps aux | egrep [l]owmem ; then
    [ -f ~/scripts/lowmem ] && ~/scripts/lowmem &
fi

# low space warning
if ! ps aux | egrep [l]owspace ; then
    [ -f ~/scripts/lowspace ] && ~/scripts/lowspace &
fi



# email client
# thunderbird &

# urxvt -e tmux &

# notification deamon
# dunst &

# start irc
# hexchat &

# web browser
# chromium &

# sound
if ! ps aux | egrep [p]pulseaudio ; then
    pulseaudio --start &
fi

# reduce monitor brigthness at night
if ! ps aux | egrep [r]edshift ; then
    which redshift && redshift &
fi

xrdb ~/.Xdefaults
xrdb ~/.Xresources
# xmodmap ~/.Xmodmap
setxkbmap de

export _JAVA_AWT_WM_NONREPARENTING=1
wmname LG3D

# compositor
# compton --backend glx --vsync opengl-swc &

# hide mouse when not needed
if ! ps aux | egrep [u]nclutter; then
    which unclutter && unclutter &
fi

# java WM tweaks
export _JAVA_OPTIONS='-Dsun.java2d.opengl=true'

# This may solve a rendering issue of Java GUIs occurring in
# window managers like awesome or dwm or bspwm
# This works because the JVM contains a hard-coded
# list of known, non-re-parenting window managers.
export _JAVA_AWT_WM_NONREPARENTING=1
wmname LG3D

# polybar
# ps aux | egrep [p]olybar || sleep 10 && while true; do SHELL=/bin/bash polybar -r stock; done &

# hotkey deamon
if ! ps aux | egrep [s]xhkd ; then
    which sxhkd && sxhkd -c $HOME/.config/sxhkd/sxhkdrc &
    which sxhkd && sxhkd -c $HOME/.config/sxhkd/sxhkdrc-bspwm &
fi

xset +fp ~/.fonts/tamzen-font/bdf &
xset fp rehash &

# load xdefaults
[[ -e ~/.Xdefaults ]] && xrdb ~/.Xdefaults
[[ -e ~/.Xresources ]] && xrdb ~/.Xresources

# speeeeed!
xset r rate 150 50

~/scripts/start-conky &
# start conky

# if ! ps aux | grep [c]onky | grep conkyrc ; then
    # (sleep 20 && while true; do conky -c ~/.config/conky/conkyrc; done) &
# fi

# if [[ $(hostname) == 'arch' ]]; then
#     if ! ps aux | grep [c]onky; then
#         conky -c /home/x/.config/conky/conkyrc &
#         conky -c ~/.config/conky/weather-syslog &
#         conky -c ~/.config/conky/charts01 &
#         conky -c ~/.config/conky/charts02 &
#         conky -c ~/.config/conky/ticker &
#     fi
# fi

# autolock screen after n mins
if ! ps aux | egrep [x]autolock ; then
    which xautlock && xautolock -time 5 -locker "$HOME/scripts/lock.sh" &
fi

which urxvt && urxvt &
